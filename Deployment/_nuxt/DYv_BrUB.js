import N from"./D0YxJZwT.js";import{h as V,s as x,r as i,e as z,c as v,a as s,t as a,f as I,b as w,u as o,i as A,d as _,g as $,n as R,w as U,o as f,k as E}from"./CXyoKjyT.js";import{_ as F}from"./Bns_f6yx.js";import{e as G}from"./4Y9A55kS.js";import{u as P}from"./605Qp5rE.js";import{u as j,r as q}from"./DXutHP6I.js";import{t as H}from"./6e0X8XZ-.js";const J={class:"container"},K={class:"layout-form custom-width"},L={class:"main-title bold lg mb-5"},O={class:"row"},Q={class:"col-12 col-md-8 mr-auto"},W={class:"text-center mb-5"},X={class:"main-title"},Y={class:"layout-activate d-flex",dir:"ltr"},Z=["disabled"],ee={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},se={class:"new-sign mt-4"},te=["disabled"],oe={key:0,class:"text-center mt-3 main-cl"},ae={class:"text-center"},ne={class:"main-title bold mb-4"},ve={__name:"mobileActivateCode",setup(le){V({useScope:"global"});const{response:h}=q(),{successToast:k,errorToast:b}=H(),g=j(),C=P(),{token:T,user:d,newPhone:y}=x(C),u=i(!1),c=i(""),n=i(!1),r=i(60),l=i(!1),S={headers:{Authorization:`Bearer ${T.value}`}},m=()=>{n.value=!0,r.value>0?setTimeout(()=>{r.value-=1,m()},1e3):(n.value=!1,r.value=60)},D=async()=>{u.value=!0;const e=new FormData;e.append("code",c.value),e.append("phone",y.value),e.append("country_code",d.value.country_code),await g.post("change-phone-check-code",e,S).then(t=>{h(t)=="success"?(l.value=!0,y.value=null,setTimeout(()=>{l.value=!1,E("/settings")},1e3)):b(t.data.msg),u.value=!1}).catch(t=>console.log(t))},B=async()=>{await g.get(`resend-code?country_code=${d.value.country_code}&phone=${d.value.phone}`).then(e=>{h(e)=="success"?(k(e.data.msg),n.value=!0,m()):b(e.data.msg)}).catch(e=>console.log(e))};return z(()=>{m()}),(e,t)=>{const M=N;return f(),v("div",null,[s("div",J,[s("div",K,[s("h1",L,a(e.$t("Auth.activation_code")),1),s("form",{onSubmit:I(D,["prevent"])},[s("div",O,[s("div",Q,[s("div",W,[t[2]||(t[2]=s("img",{src:F,loading:"lazy",alt:"restore-image",class:"restore-image mb-4"},null,-1)),s("p",X,a(e.$t("Auth.please_enter_activation_code")),1)]),s("div",Y,[w(o(G),{ref:"otpInput",value:o(c),"onUpdate:value":t[0]||(t[0]=p=>A(c)?c.value=p:null),"input-classes":"otp-input",separator:" ","num-inputs":6,"should-auto-focus":!0,"is-input-num":!0},null,8,["value"])]),s("button",{type:"submit",class:"custom-btn w-100 mr-auto",disabled:o(u)},[_(a(e.$t("Auth.confirmation"))+" ",1),o(u)?(f(),v("span",ee)):$("",!0)],8,Z),s("div",se,[_(a(e.$t("Auth.havent_received_code"))+" ",1),s("button",{type:"button",onClick:B,disabled:o(n),class:R({disabledClass:o(n)})},a(e.$t("Auth.resend_code")),11,te)]),o(n)?(f(),v("div",oe,[s("span",null,a(o(r)),1),t[3]||(t[3]=_(" : ")),t[4]||(t[4]=s("span",null,"00",-1))])):$("",!0)])])],32)])]),w(M,{visible:o(l),"onUpdate:visible":t[1]||(t[1]=p=>A(l)?l.value=p:null),modal:"",class:"custum_dialog_width without-close",draggable:!1},{default:U(()=>[s("div",ae,[s("h3",ne,a(e.$t("Global.mobile_changed_successfully")),1)])]),_:1},8,["visible"])])}}};export{ve as default};
