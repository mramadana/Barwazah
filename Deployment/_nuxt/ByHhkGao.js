import{_ as I}from"./B7V3U2pu.js";import{e as D,r as o,s as B,c as v,a as e,t as u,b as M,f as F,g as h,v as y,u as d,i as b,n as g,d as R,h as U,o as P,j}from"./CrJkl6Kt.js";import{_ as q}from"./DcOY82qG.js";import{u as z,a as E,r as G}from"./fCqHE100.js";import{t as H}from"./CUfL0nt7.js";const J={class:"container"},K={class:"auth-layout flex-column"},L={class:"main-title bold lg mb-5"},O={class:"layout-form md custom-width"},Q={class:"row"},W={class:"col-12 col-md-10 mr-auto"},X={class:"main-title bold mb-4"},Y={class:"form-group"},Z={class:"label"},x={class:"main_input with_icon"},ss=["type","placeholder"],es={class:"form-group"},ts={class:"label"},os={class:"main_input with_icon"},as=["type","placeholder"],ns={class:"custom-btn mr-auto"},ls={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},ms={__name:"confirmPassword",setup(is){const{t:c}=D({useScope:"global"}),a=o([]),n=o(""),l=o(""),{response:A}=G(),{successToast:N,errorToast:p}=H(),$=z(),T=E(),{user:f}=B(T),m=o(!1),V=o(null),i=o({definitelyNewPassword:!1,definitelyNewPassword_2:!1});function S(){a.value=[];let t=document.querySelectorAll(".validInputs");for(let s=0;s<t.length;s++)t[s].value===""&&a.value.push(c(`validation.${t[s].name}`)),n.value!==l.value&&a.value.push(c("validation.confirmPassword"))}const _=t=>i.value[t]?"text":"password",w=t=>{i.value[t]=!i.value[t]},k=async()=>{if(S(),a.value.length){p(a.value[0]);return}m.value=!0;try{const t={accountType:f.value.platformType,email:f.value.email,newPassword:n.value,confirmPassword:l.value},s=await $.post("ChangePassword",t);A(s)==="success"?(N(c("Auth.confirm_new_password")),j("/changesuccessful")):p(s.data.message)}catch(t){console.error(t),p("An error occurred. Please try again.")}finally{m.value=!1}};return(t,s)=>{const C=I;return P(),v("div",J,[e("div",K,[e("h1",L,u(t.$t("Auth.forgot_password")),1),e("div",O,[s[6]||(s[6]=e("img",{src:q,alt:"logo",class:"Auth-logo mb-5"},null,-1)),M(C,{activeSteps:[2,1],stepsCount:3}),e("form",{onSubmit:F(k,["prevent"]),ref_key:"confirmPasswordForm",ref:V},[e("div",Q,[e("div",W,[e("p",X,u(t.$t("Auth.new_password")),1),e("div",Y,[e("label",Z,u(t.$t("Auth.password_2")),1),e("div",x,[h(e("input",{type:_("definitelyNewPassword"),name:"password","onUpdate:modelValue":s[0]||(s[0]=r=>b(n)?n.value=r:null),class:"custum-input-icon validInputs",placeholder:t.$t("Auth.password_2")},null,8,ss),[[y,d(n)]]),e("button",{class:g(["static-btn with_eye",{active_class:d(i).definitelyNewPassword}]),type:"button",onClick:s[1]||(s[1]=r=>w("definitelyNewPassword"))},s[4]||(s[4]=[e("i",{class:"far fa-eye icon"},null,-1)]),2)])]),e("div",es,[e("label",ts,u(t.$t("Auth.confirm_password")),1),e("div",os,[h(e("input",{type:_("definitelyNewPassword_2"),name:"password_confirmation","onUpdate:modelValue":s[2]||(s[2]=r=>b(l)?l.value=r:null),class:"custum-input-icon validInputs",placeholder:t.$t("Auth.confirm_password")},null,8,as),[[y,d(l)]]),e("button",{class:g(["static-btn with_eye",{active_class:d(i).definitelyNewPassword_2}]),type:"button",onClick:s[3]||(s[3]=r=>w("definitelyNewPassword_2"))},s[5]||(s[5]=[e("i",{class:"far fa-eye icon"},null,-1)]),2)])]),e("button",ns,[R(u(t.$t("Auth.save"))+" ",1),d(m)?(P(),v("span",ls)):U("",!0)])])])],544)])])])}}};export{ms as default};
