import{_ as ee}from"./Dd-XoWiw.js";import se from"./DmPp5oci.js";import{s as te}from"./DtO6JiF_.js";import ae from"./CgFgIVaU.js";import{h as oe,s as le,r as n,l as ne,m as ie,c as C,a as s,t as r,f as re,j as N,p as de,u as l,i as c,v as ue,n as ce,d as y,g as M,b as S,w as D,o as k,q as z,x as B,k as P}from"./uThEF0pG.js";import{_ as me}from"./C0J6pqR-.js";import{_ as pe,a as ve}from"./Cl29S7Vg.js";import{u as q}from"./Bd7qOfwp.js";import{u as he,r as ge}from"./DXutHP6I.js";import{t as fe}from"./D12V8fHa.js";import"./DHbUyDQF.js";import"./ONLDI__z.js";import"./CSOY44ds.js";import"./BM32T4zb.js";const be={class:"container"},_e={class:"auth-layout flex-column"},we={class:"main-title bold lg mb-5"},ye={class:"layout-form md custom-width"},ke={class:"row"},Ae={class:"col-12 col-md-10 mr-auto"},$e={class:"main-title lg mb-4"},Te={class:"form-group"},Ne={class:"label"},Se=["placeholder"],De={class:"form-group"},Ie={class:"label"},Ve={class:"main_input with_icon"},Ce=["type","placeholder"],Pe={class:"section-btns mt-5 justify-content-start"},Ue=["disabled"],je={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},xe={class:"new-sign mt-4 text-start"},Ee={class:"text-center"},Le={class:"section-btns mt-4 mb-5"},Me={class:"typeSection salla"},ze={class:"typeSection zid"},Be={class:"form-group"},qe={class:"card flex justify-content-center dropdown_card"},Re=["disabled"],Fe={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},ls={__name:"teeeeeeeetstLogin",setup(Ge){const{t:p}=oe(),{user:R}=le(q()),v=n(!1),d=n(null),{response:U}=ge(),{successToast:I,errorToast:u}=fe(),A=he(),V=n({DeviceId:"Test",DeviceType:"Test",ProjectName:"barwasah"}),h=n(null),g=n(!1),m=n(!1),f=n([]),F=q(),{signInHandler:j}=F,b=n(!1),$=n([]),G=n(null);n("");const _=n(""),w=n(""),T=n(!1),H=()=>{let t=document.querySelectorAll(".validInputs");for(let e=0;e<t.length;e++)t[e].value===""&&$.value.push(p(`validation.${t[e].getAttribute("valid")}`))},x=async t=>{console.log("Selected type:",d.value);try{const e=await A.get(`/SelectPlatformAccount?email=${_.value}&account=${d.value}&password=${w.value}`),o=await e.data;e.status===200?(console.log("Platform account selected:",o),v.value=!1,I(o.message),!o.hasTwoAccounts&&o.hasNiche&&(P("/"),await j(e.data))):(console.error("Error selecting platform account:",o),u(o.message),console.log(o,"Dataaa"))}catch(e){console.error("Error making API call:",e)}},J=async()=>{var t,e;if(b.value=!0,$.value=[],H(),$.value.length){b.value=!1,u($.value[0]);return}try{const o={email:_.value,password:w.value,device:{DeviceId:V.value.DeviceId,DeviceType:V.value.DeviceType,ProjectName:V.value.ProjectName}},i=await A.post("/Login",o);i.data.statusCode===200&&i.data.key==="success"&&(I(i.data.message),await j(i.data),!i.data.hasTwoAccounts&&i.data.hasNiche&&P("/"),i.data.hasTwoAccounts&&(v.value=!0),i.data.hasNiche||(m.value=!0))}catch(o){u(((e=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:e.message)||p("messages.something_wrong"))}finally{b.value=!1}},K=()=>{T.value=!T.value},O=ne(()=>T.value?"text":"password");ie(m,t=>{t&&Q()});const Q=async()=>{try{const t=await A.get("/GetNiche");U(t)==="success"?f.value=t.data.data:u(t.data.msg)}catch(t){console.error(t),u(p("messages.something_wrong"))}finally{}},W=async()=>{if(g.value=!0,!h.value){g.value=!1,u(p("يرجى اختيار القطاع اولا"));return}try{const t=await A.post(`/SelectNiche?userId=${R.value.id}&nicheId=${h.value.id}`);U(t)==="success"?(m.value=!1,I(t.data.message),g.value=!1,P("/")):u(t.data.message)}catch(t){console.error(t),u(p("messages.something_wrong"))}finally{g.value=!1}};return(t,e)=>{const o=ee,i=se,X=te,Y=ae;return k(),C("div",be,[s("div",_e,[s("h1",we,r(t.$t("Auth.welcome")),1),s("div",ye,[e[11]||(e[11]=s("img",{src:me,alt:"logo",class:"Auth-logo mb-4"},null,-1)),s("form",{onSubmit:re(J,["prevent"]),ref_key:"loginForm",ref:G},[s("div",ke,[s("div",Ae,[s("h2",$e,r(t.$t("Auth.register_store")),1),s("div",Te,[s("label",Ne,r(t.$t("Auth.email")),1),N(s("input",{type:"email",class:"main_input validInputs",valid:"email",name:"email","onUpdate:modelValue":e[0]||(e[0]=a=>c(_)?_.value=a:null),onInput:e[1]||(e[1]=(...a)=>t.checkEmail&&t.checkEmail(...a)),placeholder:t.$t("Auth.enter_email")},null,40,Se),[[de,l(_)]])]),s("div",De,[s("label",Ie,r(t.$t("Auth.password")),1),s("div",Ve,[N(s("input",{type:l(O),class:"custum-input-icon validInputs",valid:"password",name:"password","onUpdate:modelValue":e[2]||(e[2]=a=>c(w)?w.value=a:null),placeholder:t.$t("Auth.enter_password")},null,8,Ce),[[ue,l(w)]]),s("button",{class:ce(["static-btn with_eye",{active_class:l(T)}]),type:"button",onClick:K},e[10]||(e[10]=[s("i",{class:"far fa-eye icon"},null,-1)]),2)])]),s("div",Pe,[s("button",{type:"submit",class:"custom-btn sm",disabled:l(b)},[y(r(t.$t("Auth.login"))+" ",1),l(b)?(k(),C("span",je)):M("",!0)],8,Ue),S(o,{to:"https://www.google.com/",target:"_blank",class:"custom-btn red-bg sm"},{default:D(()=>[y(r(t.$t("Auth.create_account")),1)]),_:1})]),s("div",xe,[y(r(t.$t("Auth.forget_password"))+" ",1),S(o,{to:"restorePassword"},{default:D(()=>[y(r(t.$t("Auth.restore_password")),1)]),_:1})])])])],544)])]),S(i,{visible:l(v),"onUpdate:visible":e[7]||(e[7]=a=>c(v)?v.value=a:null),modal:"",class:"custum_dialog_width without-close auth-daialog",draggable:!1},{default:D(()=>[s("div",Ee,[e[14]||(e[14]=s("h5",{class:"main-title sm blue mb-4"}," يمكنك ربط متجرك مع تطبيق بروزه من خلال سوق تطبيقات سله و زد ",-1)),e[15]||(e[15]=s("h4",{class:"main-title bold mb-5"}," متجرك على أي منصة؟ ",-1)),s("div",Le,[s("label",Me,[N(s("input",{type:"radio",value:"1",name:"checkType","onUpdate:modelValue":e[3]||(e[3]=a=>c(d)?d.value=a:null),class:"d-none",onChange:e[4]||(e[4]=a=>x("salla"))},null,544),[[z,l(d)]]),e[12]||(e[12]=s("img",{src:pe,alt:""},null,-1))]),s("label",ze,[N(s("input",{type:"radio",value:"2",name:"checkType","onUpdate:modelValue":e[5]||(e[5]=a=>c(d)?d.value=a:null),class:"d-none",onChange:e[6]||(e[6]=a=>x("zid"))},null,544),[[z,l(d)]]),e[13]||(e[13]=s("img",{src:ve,alt:""},null,-1))])])])]),_:1},8,["visible"]),S(i,{visible:l(m),"onUpdate:visible":e[9]||(e[9]=a=>c(m)?m.value=a:null),modal:"",class:"custum_dialog_width without-close auth-daialog",draggable:!1},{default:D(()=>{var a,E,L;return[e[17]||(e[17]=s("div",{class:"text-center"},[s("h4",{class:"main-title bold mb-5"}," قم بإختيار نوع القطاع اولا ")],-1)),s("div",Be,[e[16]||(e[16]=s("label",{class:"label"},"القطاع",-1)),s("div",qe,[(a=l(f))!=null&&a.length?(k(),B(X,{key:0,modelValue:l(h),"onUpdate:modelValue":e[8]||(e[8]=Z=>c(h)?h.value=Z:null),display:"chip",options:l(f),optionLabel:"name",placeholder:"اختر نوع القطاع",maxSelectedLabels:(E=l(f))==null?void 0:E.length,class:"custum-dropdown"},null,8,["modelValue","options","maxSelectedLabels"])):(k(),B(Y,{key:1,width:"100%",height:"40px"}))])]),s("button",{disabled:!((L=l(f))!=null&&L.length),type:"button",class:"custom-btn sm mr-auto mb-4",onClick:W},[y(r(t.$t("Auth.send"))+" ",1),l(g)?(k(),C("span",Fe)):M("",!0)],8,Re)]}),_:1},8,["visible"])])}}};export{ls as default};
