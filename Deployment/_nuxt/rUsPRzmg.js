const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./D0Uutl0B.js","./qYMLPQxU.js","./CDjVABWN.js"])))=>i.map(i=>d[i]);
import{_ as M}from"./BP76DtL4.js";import{s as V,j as z,A as I,B as T,m as E,r,e as O,p as U,o as A,c as C,a as t,b as c,f as B,w as N,_ as q,E as F,u as b}from"./CDjVABWN.js";import H from"./CQbogLMU.js";import{s as J}from"./D8qqV3WI.js";import{i as K,a as Q,b as W,c as X,aA as Y,d as Z,_ as aa,u as ea}from"./qYMLPQxU.js";import{u as P,r as R}from"./Bwfks3Mu.js";import{u as j}from"./CVjljgFj.js";import{i as G}from"./BOjzTTy3.js";import{_ as ta}from"./D4mcGiyH.js";import{a as sa,_ as oa}from"./DyTDoOJv.js";import"./vdJJGTyi.js";import"./GeIhuEdx.js";import"./BXjy7pqY.js";import"./BbxwispC.js";const na=Z(aa),ra={key:0,class:"skeleton-chart"},la={class:"skeleton-bars"},ia={class:"d-flex align-items-center gap-3 justify-content-end"},ca={key:0,class:"w-100"},da={class:"d-flex align-items-center justify-content-center gap-4"},ua={class:"with_cun_select custom-select"},ma={class:"flex justify-content-center dropdown_card"},pa={__name:"Orders",props:{apiEndpoint:{type:String,required:!0}},async setup(S){let d,h;const u=P(),{response:D}=R(),{token:f}=V(j());z();const g=S,y=([d,h]=I(()=>T(()=>import("./D0Uutl0B.js"),__vite__mapDeps([0,1,2]),import.meta.url)),d=await d,h(),d);y.use([G,K,Q,W,X]);const $=E(()=>({headers:{Authorization:`Bearer ${f.value}`}})),v=r(!1),m=r(null),p=r(null),x=r([]),e=r([{name:"عرض الكل",id:0},{name:"يناير",id:1,days:31},{name:"فبراير",id:2,days:28},{name:"مارس",id:3,days:31},{name:"أبريل",id:4,days:30},{name:"مايو",id:5,days:31},{name:"يونيو",id:6,days:30},{name:"يوليو",id:7,days:31},{name:"أغسطس",id:8,days:31},{name:"سبتمبر",id:9,days:30},{name:"أكتوبر",id:10,days:31},{name:"نوفمبر",id:11,days:30},{name:"ديسمبر",id:12,days:31}]),a=r({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[],axisLabel:{interval:0,rotate:45}},yAxis:{type:"value",show:!1},series:[{type:"line",smooth:!0,symbol:"square",symbolSize:7,showSymbol:!0,lineStyle:{width:2,color:"#4681f4"},itemStyle:{color:"#013660"},areaStyle:{color:new y.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(247, 92, 92, 0.6)"},{offset:1,color:"rgba(247, 92, 92, 0.2)"}])},data:[]}]}),w=async(o=0)=>{var s,_;v.value=!0;try{const i=await u.get(`${g.apiEndpoint}${o?`?filterByMonth=${o}`:""}`,$.value);if(console.log("API Response:",i.data),D(i)==="success"){if(!((s=i.data)!=null&&s.data)){console.log("No data found in response"),a.value.xAxis.data=[],a.value.series[0].data=[];return}const l=i.data.data;console.log("Chart Data 222:",l),x.value=l;try{o===0?(a.value.xAxis.data=l.map(n=>n.month),a.value.series[0].data=l.map(n=>n.value)):(a.value.xAxis.data=l.map(n=>`اليوم ${n.month}`),a.value.series[0].data=l.map(n=>n.value)),(_=p.value)!=null&&_.chart&&p.value.chart.setOption(a.value,!0)}catch(n){console.error("Error mapping data:",n),console.log("Data structure:",l),a.value.xAxis.data=[],a.value.series[0].data=[]}}}catch(i){console.error("Error fetching peak time data:",i),a.value.xAxis.data=[],a.value.series[0].data=[]}finally{v.value=!1}},k=async o=>{var _;const s=(_=o.value)==null?void 0:_.id;s!==void 0&&await w(s)};return O(async()=>{m.value=e.value[0],await w()}),U(x,()=>{var o;(o=p.value)!=null&&o.chart&&p.value.chart.setOption(a.value,!0)},{deep:!0}),(o,s)=>{const _=H,i=J,l=na,n=Y;return A(),C("div",null,[v.value?(A(),C("div",ra,[t("div",la,[t("div",ia,[c(_,{width:"5rem",height:".5rem"}),s[1]||(s[1]=t("div",{class:"skeleton-bar",style:{width:"80%"}},null,-1))])])])):B("",!0),c(n,null,{default:N(()=>[v.value?B("",!0):(A(),C("div",ca,[t("div",da,[t("div",ua,[t("div",ma,[c(i,{modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=L=>m.value=L),onChange:k,options:e.value,optionLabel:"name",placeholder:"اختر الشهر",class:"w-full md:w-14rem custum-dropdown"},null,8,["modelValue","options"])])])]),c(l,{ref_key:"chart",ref:p,class:"custom-chart",option:a.value,style:{height:"300px",width:"100%",display:"block"}},null,8,["option"])]))]),_:1})])}}},_a={class:"info-box-item cart-clients gap-5 flex-wrap mb-4"},fa={class:"layout-form chart_layout"},va={class:"layout-form chart_layout"},ha={class:"layout-form"},ya={__name:"salesDetails",setup(S){ea([G]);const{response:d}=R(),h=P(),u=r([]),{token:D}=V(j()),f=r(!1),g=r(!1),y=E(()=>({headers:{Authorization:`Bearer ${D.value}`}})),$=r({showAll:"معدل الترك",males:"الاقسام",females:"المنتجات"}),v=E(()=>u.value?{labels:u.value.map(e=>({id:e.id,text:e.name,image:e.logo})),series:u.value.map(e=>Number(e.precentage.toFixed(2))),colors:{bar:"#013660",text:"#ffffff"}}:{labels:[],series:[],colors:{bar:"#f75c5c",text:"#ffffff"}}),m=r([]),p=async()=>{f.value=!0,await h.get("DropoutRate",y.value).then(e=>{d(e)=="success"&&(u.value=e.data.data,console.log(u.value,"HomeData")),f.value=!1}).catch(e=>{console.error(e)})},x=async()=>{f.value=!0;try{const e=await h.get("AbandonedCartRateForGender?GenderType=0",y.value);if(d(e)==="success"){const a=e.data.data;Array.isArray(a)?(m.value=a,console.log("Updated Source Data:",m.value)):console.error("demographicData is not an array:",a)}}catch(e){console.error("Error fetching demographic data:",e)}finally{f.value=!1}};return O(async()=>{await x(),await p()}),F(()=>{g.value=!0}),(e,a)=>{const w=M,k=pa,o=ta,s=oa;return A(),C("div",null,[t("div",_a,[a[1]||(a[1]=t("div",{class:"d-flex gap-3 justify-content-center flex-grow-1 align-items-center"},[t("img",{src:sa,alt:"User Icon"}),t("div",{class:"info-content"},[t("span",null,"إجمالي قيمة السلات المتروكة للمتجر:"),t("h2",null,"99000 ريال")])],-1)),c(w,{to:"/sales"},{default:N(()=>a[0]||(a[0]=[t("i",{class:"fas fa-chevron-right sales-icon"},null,-1)])),_:1})]),t("div",fa,[a[2]||(a[2]=t("h1",{class:"main-title bold text-center mb-5"},"متوسط حجم السلات المتروكة",-1)),c(k,{apiEndpoint:"AverageAbandonedCartSize"})]),t("div",va,[c(o,{"data-ready":b(g),"products-data":b(v)},null,8,["data-ready","products-data"])]),t("div",ha,[c(s,{"rental-names":b($),"source-data":b(m)},null,8,["rental-names","source-data"])])])}}},Na=q(ya,[["__scopeId","data-v-fb206173"]]);export{Na as default};
