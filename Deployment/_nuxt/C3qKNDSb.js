import{_ as M}from"./C8bX-7w0.js";import R from"./P9mYRXpx.js";import{e as B,s as F,r as n,c as A,a as s,t as p,b as T,f as P,g as f,m as z,d as j,u as v,h as q,w as x,i as h,o as $,p as S,j as k}from"./CaDz3XmI.js";import{_ as E}from"./BFZIU_pA.js";import{_ as G,a as H}from"./Dhidt8hy.js";import{u as J,a as K,r as L}from"./DSoeTSnF.js";import{t as O}from"./VBNMALfX.js";const Q={class:"container"},W={class:"auth-layout flex-column"},X={class:"main-title bold lg mb-5"},Y={class:"layout-form md custom-width"},Z={class:"row"},ee={class:"col-12 col-md-10 mr-auto"},se={class:"mb-4"},te={class:"main-title"},oe={class:"form-group mb-5"},ae={class:"label"},le=["placeholder"],ne={type:"submit",class:"custom-btn mr-auto"},ie={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},re={class:"text-center"},ue={class:"section-btns mt-4 mb-5"},ce={class:"typeSection salla"},de={class:"typeSection zid"},we={__name:"restorepassword",setup(me){const{locale:pe,t:C}=B({useScope:"global"}),{response:g}=L(),{successToast:_,errorToast:r}=O(),b=J(),V=K(),{user:u,hasTwoAccount:I,newemail:N}=F(V),y=n(null),c=n(!1),i=n(null),d=n(!1),m=n([]);n({}),n([]);function U(){let t=document.querySelectorAll(".validInputs");for(let e=0;e<t.length;e++)t[e].value===""&&m.value.push(C(`validation.${t[e].name}`))}const D=async()=>{var t;try{d.value=!0;const e=new FormData(y.value);if(U(),m.value.length){r(m.value[0]);return}const l=e.get("email"),o=await b.post(`SendCode?email=${l}`);g(o)==="success"?(N.value=l,(t=u.value)!=null&&t.email&&(u.value.email=e.get("email")),_(o.data.message),I.value=o.data.hasTwoAccounts,o.data.hasTwoAccounts?c.value=!0:k("/Auth/restorepassword-check-code")):r(o.data.msg)}catch(e){console.error(e),d.value=!0,r("An error occurred. Please try again.")}finally{d.value=!1,m.value=[]}},w=async t=>{try{const e=encodeURIComponent(u.value.email),l=t==="salla"?1:2,o=await b.post(`SendCode?email=${e}&accountType=${l}`);g(o)==="success"?(_(o.data.message),c.value=!1,u.value.accountType=l,k("/Auth/restorepassword-check-code"),console.log(u.value,"new user")):r(o.data.msg)}catch(e){console.error(e),r("An error occurred. Please try again.")}finally{}};return(t,e)=>{const l=M,o=R;return $(),A("div",Q,[s("div",W,[s("h1",X,p(t.$t("Auth.forgot_password")),1),s("div",Y,[e[10]||(e[10]=s("img",{src:E,alt:"logo",class:"Auth-logo mb-5"},null,-1)),T(l,{activeSteps:[3]}),s("form",{onSubmit:P(D,["prevent"]),ref_key:"forgetForm",ref:y},[s("div",Z,[s("div",ee,[s("div",se,[s("p",te,p(t.$t("Auth.get_code")),1)]),s("div",oe,[s("label",ae,p(t.$t("Auth.email")),1),f(s("input",{type:"email",class:"main_input validInputs",valid:"email",name:"email","onUpdate:modelValue":e[0]||(e[0]=a=>t.email=a),placeholder:t.$t("Auth.enter_email")},null,8,le),[[z,t.email]])]),s("button",ne,[j(p(t.$t("Auth.send"))+" ",1),v(d)?($(),A("span",ie)):q("",!0)])])])],544),T(o,{visible:v(c),"onUpdate:visible":e[5]||(e[5]=a=>h(c)?c.value=a:null),modal:"",class:"custum_dialog_width without-close auth-daialog",draggable:!1},{default:x(()=>[s("div",re,[e[8]||(e[8]=s("h5",{class:"main-title sm blue mb-4"}," يمكنك ربط متجرك مع تطبيق بروزه من خلال سوق تطبيقات سله و زد ",-1)),e[9]||(e[9]=s("h4",{class:"main-title bold mb-5"}," متجرك على أي منصة؟ ",-1)),s("div",ue,[s("label",ce,[f(s("input",{type:"radio",value:"1",name:"checkType","onUpdate:modelValue":e[1]||(e[1]=a=>h(i)?i.value=a:null),class:"d-none",onChange:e[2]||(e[2]=a=>w("salla"))},null,544),[[S,v(i)]]),e[6]||(e[6]=s("img",{src:G,alt:""},null,-1))]),s("label",de,[f(s("input",{type:"radio",value:"2",name:"checkType","onUpdate:modelValue":e[3]||(e[3]=a=>h(i)?i.value=a:null),class:"d-none",onChange:e[4]||(e[4]=a=>w("zid"))},null,544),[[S,v(i)]]),e[7]||(e[7]=s("img",{src:H,alt:""},null,-1))])])])]),_:1},8,["visible"])])])])}}};export{we as default};
