import{_ as x}from"./C1HUXTLU.js";import{r as c,e as I,s as M,x as N,c as p,a as s,t as l,b as y,f as V,u as o,i as B,d as _,h as g,n as D,o as v,j as G}from"./XwzDhOAl.js";import{_ as R}from"./Dr9W2RfY.js";import{e as j}from"./DO4mRTPC.js";import{u as z,a as E,r as P}from"./BgL8rdcg.js";import{t as U}from"./Big3NplA.js";const q={class:"container"},F={class:"auth-layout flex-column"},H={class:"main-title bold lg mb-5"},J={class:"layout-form md custom-width"},K={class:"row"},L={class:"col-12 col-md-8 mr-auto"},O={class:"text-center mb-5"},Q={class:"main-title"},W={class:"layout-activate d-flex",dir:"ltr"},X=["disabled"],Y={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Z={class:"new-sign mt-4 text-center"},ss=["disabled"],es={key:0,class:"text-center mt-3 main-cl"},us={__name:"emailActivateCode",setup(ts){const a=c(!1),u=c(60),d=()=>{a.value=!0,u.value>0?setTimeout(()=>{u.value-=1,d()},1e3):(a.value=!1,u.value=60)},{t:f}=I({useScope:"global"}),{response:h}=P(),{successToast:w,errorToast:r}=U(),b=z(),C=E(),{user:m,newemail:T}=M(C),i=c(!1),n=c(""),A=async()=>{i.value=!0;const e={email:T.value,code:parseInt(n.value),accountType:m.value.platformType};if(!n.value)r(f("validation.code")),i.value=!1;else try{const t=await b.post("ConfirmCode",e);h(t)==="success"?(G("/confirmPassword"),localStorage.setItem("newCode",n.value)):r(t.data.msg)}catch(t){r(t.response.data.message)}finally{i.value=!1}},S=async()=>{try{const e=await b.post(`SendCode?email=${m.value.email}&accountType=${m.value.platformType}`);h(e)==="success"?(w(e.data.message),a.value=!0,d()):r(e.data.message)}catch(e){console.error(e),r(f("Global.error_occurred"))}};return N(()=>{d()}),(e,t)=>{const $=x;return v(),p("div",q,[s("div",F,[s("h1",H,l(e.$t("Auth.forgot_password")),1),s("div",J,[t[3]||(t[3]=s("img",{src:R,alt:"logo",class:"Auth-logo mb-5"},null,-1)),y($,{activeSteps:[3,2],stepsCount:3}),s("form",{onSubmit:V(A,["prevent"])},[s("div",K,[s("div",L,[s("div",O,[s("p",Q,l(e.$t("Auth.send_code")),1)]),s("div",W,[y(o(j),{ref:"otpInput",value:o(n),"onUpdate:value":t[0]||(t[0]=k=>B(n)?n.value=k:null),"input-classes":"otp-input",separator:" ","num-inputs":6,"should-auto-focus":!0,"is-input-num":!0},null,8,["value"])]),s("button",{type:"submit",class:"custom-btn mr-auto",disabled:o(i)},[_(l(e.$t("Auth.reset_password"))+" ",1),o(i)?(v(),p("span",Y)):g("",!0)],8,X),s("div",Z,[_(l(e.$t("Auth.havent_received_code"))+" ",1),s("button",{type:"button",onClick:S,disabled:o(a),class:D({disabledClass:o(a)})},l(e.$t("Auth.resend_code")),11,ss)]),o(a)?(v(),p("div",es,[s("span",null,l(o(u)),1),t[1]||(t[1]=_(" : ")),t[2]||(t[2]=s("span",null,"00",-1))])):g("",!0)])])],32)])])])}}};export{us as default};
