const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DtRkRCOL.js","./ZFKUsYYo.js","./XwzDhOAl.js","./entry.B0b_3z4T.css"])))=>i.map(i=>d[i]);
import{_ as se,e as re,s as oe,k as q,y as le,z as ne,r as n,x as ie,u as t,o as c,c as u,a as o,b as I,F as ce,A as ue,n as de,t as y,h as f,w as me,d as Y,i as pe}from"./XwzDhOAl.js";import{i as he,a as ye,b as fe,c as ve,d as _e,_ as ge}from"./ZFKUsYYo.js";import be from"./BWT1pwu6.js";import{u as xe,a as ke,r as we}from"./BgL8rdcg.js";import{i as Se}from"./ImKPgduO.js";const De=_e(ge),Ce={key:0,class:"w-100"},$e={class:"chart-container"},Ye={class:"year-labels"},Ie=["onClick"],Fe={key:0,class:"year-text"},Ee={class:"dialog-content"},Ae={class:"main-title main-cl lg normal text-center mb-4"},Be={key:0,class:"mb-2 d-flex gap-2 justify-content-between main-cl mb-3"},Ge={class:"value"},Le={key:1,class:"mb-2 d-flex gap-2 justify-content-between main-cl mb-3"},Ne={class:"value"},Re={key:2,class:"mb-2 d-flex gap-2 justify-content-between main-cl mb-3"},ze={class:"value"},Ve={key:0,class:"d-flex gap-2 justify-content-center main-cl mt-4 mb-3"},Me={__name:"testbusinessGrowth",async setup(J){let v,_;re();const m=xe(),{response:g}=we(),{token:K}=oe(ke()),b=q(()=>({headers:{Authorization:`Bearer ${K.value}`}})),D=([v,_]=le(()=>ne(()=>import("./DtRkRCOL.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),v=await v,_(),v);D.use([Se,he,ye,fe,ve]);const F=n(!1),E=n(!1),d=n({marketData:[],storeDataData:[]}),p=n(null),r=n({}),w=n(null),S=n([{name:"عرض الكل",id:0}]),Q=async(a=0)=>{try{E.value=!0;const e=await m.get(`BusinessGrowthChart?year=${a}`,b.value);if(g(e)==="success"){d.value={marketData:e.data.data.marketData,storeDataData:e.data.data.storeDataData};const s=e.data.data.marketData.map(i=>({name:i.year.toString(),id:parseInt(i.year)}));S.value=[{name:"عرض الكل",id:0},...s],console.log(s,"4554454554",S.value),X()}}catch(e){console.error("Error fetching chart data:",e)}finally{E.value=!1}},X=()=>{const a=d.value.marketData.map(e=>e.year);k.value.xAxis.data=a,k.value.series[0].data=d.value.marketData.map(e=>e.value),k.value.series[1].data=d.value.storeDataData.map(e=>e.value),p.value&&p.value.chart&&p.value.chart.setOption(k.value,!0)},h=n(!1),x=n("");n({});const Z=async a=>{if(a.componentType==="xAxis"){const e=parseInt(a.value,10);x.value=e;try{const s=await m.get(`YearIndicators?year=${e}`,b.value);g(s)==="success"&&(r.value=s.data.data,h.value=!0)}catch(s){console.error("Error fetching year indicators:",s)}}else if(a&&a.name){const e=parseInt(a.name,10);x.value=e;try{const s=await m.get(`YearIndicators?year=${e}`,b.value);g(s)==="success"&&(r.value=s.data.data,h.value=!0)}catch(s){console.error("Error fetching year indicators:",s)}}},ee=async a=>{const e=parseInt(a,10);x.value=e;try{const s=await m.get(`YearIndicators?year=${e}`,b.value);g(s)==="success"&&(r.value=s.data.data,h.value=!0)}catch(s){console.error("Error fetching year indicators:",s)}},k=n({legend:{bottom:"0%",show:!0,left:"center",icon:"circle",itemWidth:8,itemHeight:8,itemGap:25,textStyle:{color:"#2B3674",fontSize:11,fontFamily:"Cairo",padding:[0,10,0,0]}},tooltip:{trigger:"axis",axisPointer:{type:"none",shadowStyle:{opacity:0}},formatter:a=>{let e=`<div style="padding: 5px;">${a[0].axisValue}</div>`;return a.forEach(s=>{const i=Number(s.value);let l;s.seriesIndex===0?l=Number.isInteger(i)?`${i}`:`${i.toFixed(2)}`:l=Number.isInteger(i)?`${i}`:`${i.toFixed(2)}%`,e+=`
             <div style="display: flex; align-items: center; gap: 8px;">
               <span style="display:inline-block;width:8px;height:8px;border-radius:50%;background:${s.color};"></span>
               <span>${s.seriesName}: <b>${l}</b></span>
             </div>
           `}),e}},grid:{left:"3%",right:"4%",bottom:"15%",top:"5%",containLabel:!0},xAxis:{type:"category",boundaryGap:!0,data:[],axisLine:{lineStyle:{color:"#E2E8F0"}},axisLabel:{interval:0,color:"#2B3674",fontFamily:"Cairo",fontSize:12,show:!0,clickable:!0,rich:{a:{color:"#2B3674",fontFamily:"Cairo",fontSize:12,cursor:"pointer",textDecoration:"underline"}},formatter:function(a){return"{a|"+a+"}"}}},yAxis:{type:"value",show:!1,splitLine:{lineStyle:{color:"#E2E8F0",type:"dashed"}},axisLabel:{color:"#2B3674",fontFamily:"Cairo",fontSize:12}},series:[{name:"اجمالي المبيعات للمتجر خلال السنة",type:"line",smooth:.5,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#2B3674"},itemStyle:{color:"#2B3674",borderWidth:2},areaStyle:{opacity:.3,color:new D.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(43, 54, 116, 0.3)"},{offset:1,color:"rgba(43, 54, 116, 0.05)"}])},data:[]},{name:"الحصة السوقية للمتجر من السوق",type:"line",smooth:.5,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#FF647C"},itemStyle:{color:"#FF647C",borderWidth:2},areaStyle:{opacity:.3,color:new D.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(255, 100, 124, 0.3)"},{offset:1,color:"rgba(255, 100, 124, 0.05)"}])},data:[]}]}),te=q(()=>{if(!d.value.marketData||d.value.marketData.length===0)return[];if(!w.value||w.value.id===0)return d.value.marketData.map(e=>e.year.toString());const a=w.value.id;return d.value.marketData.filter(e=>parseInt(e.year)>=a).map(e=>e.year.toString())}),C=n(""),ae=async()=>{try{const a=await m.get("GetGrowthReport",b.value);g(a)==="success"&&(C.value=a.data.data)}catch(a){console.error("Error fetching growth report:",a)}};return ie(async()=>{await Q(0),await ae(),S.value.length>0&&(w.value=S.value[0]),F.value=!0,p.value&&p.value.chart&&p.value.chart.on("click",Z)}),(a,e)=>{const s=De,i=be;return t(F)?(c(),u("div",Ce,[e[6]||(e[6]=o("div",{class:"d-flex align-items-center justify-content-center gap-4 mb-4"},null,-1)),o("div",$e,[I(s,{ref_key:"chart",ref:p,class:"custom-chart chart-height",option:t(k),style:{height:"300px",width:"100%",display:"block"}},null,8,["option"]),o("div",Ye,[(c(!0),u(ce,null,ue(t(te),l=>(c(),u("div",{key:l,class:de(["year-label",{active:t(x)===l}]),onClick:$=>ee(l)},y(l),11,Ie))),128))]),t(C)?(c(),u("div",Fe,[e[1]||(e[1]=o("h3",{class:"main-title bold main-cl mb-3"},"تقرير نمو",-1)),o("h5",null,y(t(C)),1)])):f("",!0)]),I(i,{visible:t(h),"onUpdate:visible":e[0]||(e[0]=l=>pe(h)?h.value=l:null),class:"auth-daialog custum_dialog_width",modal:""},{default:me(()=>{var l,$,A,B,G,L,N,R,z,V,M,P,T,j,O,W,H,U;return[o("div",Ee,[o("h3",Ae,"مؤشرات سنة "+y(t(x)),1),o("ul",null,[((l=t(r))==null?void 0:l.salesYear)!==null&&(($=t(r))==null?void 0:$.salesYear)!=="0%"&&((A=t(r))==null?void 0:A.salesYear)!=="0ريال"?(c(),u("li",Be,[e[2]||(e[2]=Y("مبيعات السنة: ")),o("span",Ge,y((B=t(r))==null?void 0:B.salesYear),1)])):f("",!0),((G=t(r))==null?void 0:G.storeMarketShare)!==null&&((L=t(r))==null?void 0:L.storeMarketShare)!=="0%"&&((N=t(r))==null?void 0:N.storeMarketShare)!=="0ريال"?(c(),u("li",Le,[e[3]||(e[3]=Y("الحصة السوقية للمتجر: ")),o("span",Ne,y((R=t(r))==null?void 0:R.storeMarketShare),1)])):f("",!0),((z=t(r))==null?void 0:z.repeatPurchaseRate)!==null&&((V=t(r))==null?void 0:V.repeatPurchaseRate)!=="0%"&&((M=t(r))==null?void 0:M.repeatPurchaseRate)!=="0ريال"?(c(),u("li",Re,[e[4]||(e[4]=Y("نسبة تكرار الشراء: ")),o("span",ze,y((P=t(r))==null?void 0:P.repeatPurchaseRate),1)])):f("",!0)]),((T=t(r))==null?void 0:T.salesYear)===null||((j=t(r))==null?void 0:j.salesYear)==="0%"||((O=t(r))==null?void 0:O.salesYear)==="0ريال"||((W=t(r))==null?void 0:W.storeMarketShare)===null||((H=t(r))==null?void 0:H.storeMarketShare)==="0%"||((U=t(r))==null?void 0:U.storeMarketShare)==="0ريال"?(c(),u("li",Ve,e[5]||(e[5]=[o("span",{class:"value"},"ليس لديك بيانات مسجله لهذه السنة",-1)]))):f("",!0)])]}),_:1},8,["visible"])])):f("",!0)}}},Pe=se(Me,[["__scopeId","data-v-d46b23ce"]]),Te={class:"container"},je={class:"layout-form chart_layout"},Je={__name:"businessGrowth",setup(J){return(v,_)=>{const m=Pe;return c(),u("div",Te,[o("div",je,[_[0]||(_[0]=o("h3",{class:"main-title fw-normal text-center mb-4"},"نمو الاعمال",-1)),I(m)])])}}};export{Je as default};
