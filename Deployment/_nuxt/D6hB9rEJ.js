import{_ as x}from"./C8bX-7w0.js";import{r as d,e as I,s as M,x as N,c as p,a as s,t as r,b,f as V,u as o,i as B,d as v,h as y,n as D,o as _,j as P}from"./CaDz3XmI.js";import{_ as R}from"./BFZIU_pA.js";import{e as j}from"./CmP0eS4Y.js";import{u as z,a as E,r as G}from"./DSoeTSnF.js";import{t as U}from"./VBNMALfX.js";const q={class:"container"},F={class:"auth-layout flex-column"},H={class:"main-title bold lg mb-5"},J={class:"layout-form md custom-width"},K={class:"row"},L={class:"col-12 col-md-8 mr-auto"},O={class:"text-center mb-5"},Q={class:"main-title"},W={class:"layout-activate d-flex",dir:"ltr"},X=["disabled"],Y={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Z={class:"new-sign mt-4 text-center"},ss=["disabled"],es={key:0,class:"text-center mt-3 main-cl"},us={__name:"restorePassword-check-code",setup(ts){const a=d(!1),u=d(60),m=()=>{a.value=!0,u.value>0?setTimeout(()=>{u.value-=1,m()},1e3):(a.value=!1,u.value=60)},{t:g}=I({useScope:"global"}),{response:f}=G(),{successToast:w,errorToast:i}=U(),h=z(),T=E(),{user:n,hasTwoAccount:os,newemail:A}=M(T),c=d(!1),l=d(""),C=async()=>{c.value=!0;const e={email:n.value.email?n.value.email:A.value,code:parseInt(l.value),accountType:n.value.accountType?n.value.accountType:0};if(!l.value)i(g("validation.code")),c.value=!1;else try{const t=await h.post("ConfirmCode",e);f(t)==="success"?(P("/Auth/confirmPassword"),localStorage.setItem("newCode",l.value)):i(t.data.message)}catch(t){i(t.response.data.message)}finally{c.value=!1}},S=async()=>{try{const e=await h.post(`SendCode?email=${n.value.email}&accountType=${n.value.accountType}`);f(e)==="success"?(w(e.data.message),a.value=!0,m()):i(e.data.message)}catch(e){i(e.response.data.message)}};return N(()=>{m()}),(e,t)=>{const $=x;return _(),p("div",q,[s("div",F,[s("h1",H,r(e.$t("Auth.forgot_password")),1),s("div",J,[t[3]||(t[3]=s("img",{src:R,alt:"logo",class:"Auth-logo mb-5"},null,-1)),b($,{activeSteps:[3,2]}),s("form",{onSubmit:V(C,["prevent"])},[s("div",K,[s("div",L,[s("div",O,[s("p",Q,r(e.$t("Auth.send_code")),1)]),s("div",W,[b(o(j),{ref:"otpInput",value:o(l),"onUpdate:value":t[0]||(t[0]=k=>B(l)?l.value=k:null),"input-classes":"otp-input",separator:" ","num-inputs":6,"should-auto-focus":!0,"is-input-num":!0},null,8,["value"])]),s("button",{type:"submit",class:"custom-btn mr-auto",disabled:o(c)},[v(r(e.$t("Auth.reset_password"))+" ",1),o(c)?(_(),p("span",Y)):y("",!0)],8,X),s("div",Z,[v(r(e.$t("Auth.havent_received_code"))+" ",1),s("button",{type:"button",onClick:S,disabled:o(a),class:D({disabledClass:o(a)})},r(e.$t("Auth.resend_code")),11,ss)]),o(a)?(_(),p("div",es,[s("span",null,r(o(u)),1),t[1]||(t[1]=v(" : ")),t[2]||(t[2]=s("span",null,"00",-1))])):y("",!0)])])],32)])])])}}};export{us as default};
