import{_ as is}from"./9qrM1zd5.js";import us from"./fh9SRgvk.js";import{s as rs}from"./pwy7stKT.js";import ds from"./DMunnmqN.js";import{e as cs,s as ms,r as o,k as ps,l as vs,c as V,a as t,t as r,f as gs,g as I,m as fs,u as l,i as m,v as bs,n as hs,h as z,d as $,b as T,w as A,o as b,p as F,q as G,j as H}from"./3aNOyP8F.js";import{_ as _s}from"./xI-qUkr4.js";import{_ as J,a as K}from"./DvgW_liT.js";import{a as O,u as ys,r as ws}from"./D1C0XMuM.js";import{t as ks}from"./CmVCLdfQ.js";import"./BWqzMzYR.js";import"./Dgq8-pWz.js";import"./kxYbx_TQ.js";import"./CQJHf3CT.js";const $s={class:"container"},Ts={class:"auth-layout flex-column"},As={class:"main-title bold lg mb-5"},Ss={class:"layout-form md custom-width"},Cs={class:"row"},Ds={class:"col-12 col-md-10 mr-auto"},Ns={class:"main-title lg mb-4"},Vs={class:"form-group"},Is={class:"label"},Us=["placeholder"],xs={key:0,class:"form-group"},js={class:"label"},zs={class:"main_input with_icon"},Ps=["type","placeholder"],Ms={class:"section-btns mt-5 justify-content-start"},Bs=["disabled"],Ls={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},qs={class:"new-sign mt-4 text-start"},Es={class:"new-sign mt-3 text-start"},Rs={class:"text-center"},Fs={class:"section-btns mt-4 mb-4"},Gs={class:"text-center"},Hs={class:"section-btns mt-4 mb-5"},Js={class:"typeSection salla"},Ks={class:"typeSection zid"},Os={class:"form-group"},Qs={class:"card flex justify-content-center dropdown_card"},Ws=["disabled"],Xs={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},me={__name:"login",setup(Ys){const{t:p}=cs(),{user:U,token:P}=ms(O()),h=o(!1),i=o(null),g=o(!1),{response:M}=ws(),{successToast:x,errorToast:n}=ks(),S=ys(),j=o({DeviceId:"Test",DeviceType:"Test",ProjectName:"barwasah"}),_=o(null),y=o(!1),f=o(!1),w=o([]),Q=O(),{signInHandler:W}=Q,d=o(!1),v=o([]),X=o(null);o("");const k=o(""),C=o(""),D=o(!1),N=o(!1),B=()=>{let e=document.querySelectorAll(".validInputs");for(let s=0;s<e.length;s++)e[s].value===""&&v.value.push(p(`validation.${e[s].getAttribute("valid")}`))},L=()=>{console.log("Selected type:",i.value),h.value=!1,i.value&&(N.value=!0)},Y=async()=>{if(v.value=[],d.value=!0,B(),v.value.length){d.value=!1,n(v.value[0]);return}try{const e=await S.get(`/CheckEmail?email=${k.value}`);e.data.key==="success"?(x(p("validation.right_email")),e.data.hasTwoAccounts?(h.value=!0,i.value=null):N.value=!0):n(e.data.message)}catch(e){e.response&&e.response.status===400?n(e.response.data.message):n(p("messages.something_wrong"))}finally{d.value=!1}},Z=async()=>{var e,s;if(!N.value){Y();return}if(d.value=!0,v.value=[],B(),v.value.length){d.value=!1,n(v.value[0]);return}try{const c={email:k.value,password:C.value,accountType:i.value||0,device:{DeviceId:j.value.DeviceId,DeviceType:j.value.DeviceType,ProjectName:j.value.ProjectName}},u=await S.post("/Login",c);u.data.statusCode===200&&u.data.key==="success"&&(x(u.data.message),await W(u.data),u.data.hasNiche?H("/home"):f.value=!0)}catch(c){n(((s=(e=c==null?void 0:c.response)==null?void 0:e.data)==null?void 0:s.message)||p("messages.something_wrong"))}finally{d.value=!1}},ss=()=>{D.value=!D.value},es=ps(()=>D.value?"text":"password");vs(f,e=>{e&&ts()});const ts=async()=>{try{const e=await S.get("/GetNiche");M(e)==="success"?w.value=e.data.data:n(e.data.msg)}catch(e){console.error(e),n(p("messages.something_wrong"))}finally{}},as=async()=>{if(y.value=!0,!_.value){y.value=!1,n(p("يرجى اختيار القطاع اولا"));return}try{const e=await S.post(`/SelectNiche?userId=${U.value.id}&nicheId=${_.value.id}`);M(e)==="success"?(f.value=!1,x(e.data.message),y.value=!1,U.value=e.data.data,P.value=e.data.data.token,console.log(U.value,"user Dataaaa",P.value),H("/home")):n(e.data.message)}catch(e){console.error(e),n(p("messages.something_wrong"))}finally{y.value=!1}},q=e=>{window==null||window.open(e,"_blank")};return(e,s)=>{const c=is,u=us,ls=rs,os=ds;return b(),V("div",$s,[t("div",Ts,[t("h1",As,r(e.$t("Auth.welcome")),1),t("div",Ss,[s[15]||(s[15]=t("img",{src:_s,alt:"logo",class:"Auth-logo mb-4"},null,-1)),t("form",{onSubmit:gs(Z,["prevent"]),ref_key:"loginForm",ref:X},[t("div",Cs,[t("div",Ds,[t("h2",Ns,r(e.$t("Auth.register_store")),1),t("div",Vs,[t("label",Is,r(e.$t("Auth.email")),1),I(t("input",{type:"email",class:"main_input validInputs",valid:"email",name:"email","onUpdate:modelValue":s[0]||(s[0]=a=>m(k)?k.value=a:null),placeholder:e.$t("Auth.enter_email")},null,8,Us),[[fs,l(k)]])]),l(N)?(b(),V("div",xs,[t("label",js,r(e.$t("Auth.password")),1),t("div",zs,[I(t("input",{type:l(es),class:"custum-input-icon validInputs",valid:"password",name:"password","onUpdate:modelValue":s[1]||(s[1]=a=>m(C)?C.value=a:null),placeholder:e.$t("Auth.enter_password")},null,8,Ps),[[bs,l(C)]]),t("button",{class:hs(["static-btn with_eye",{active_class:l(D)}]),type:"button",onClick:ss},s[13]||(s[13]=[t("i",{class:"far fa-eye icon"},null,-1)]),2)])])):z("",!0),t("div",Ms,[t("button",{type:"submit",class:"custom-btn sm",disabled:l(d)},[$(r(e.$t("Auth.login"))+" ",1),l(d)?(b(),V("span",Ls)):z("",!0)],8,Bs),t("button",{type:"button",onClick:s[2]||(s[2]=a=>g.value=!0),class:"custom-btn red-bg sm"},r(e.$t("Auth.create_account")),1)]),t("div",qs,[$(r(e.$t("Auth.forget_password"))+" ",1),T(c,{to:"restorePassword"},{default:A(()=>[$(r(e.$t("Auth.restore_password")),1)]),_:1})]),t("div",Es,[T(c,{to:"/"},{default:A(()=>s[14]||(s[14]=[$("الذهاب للصفحة الرئيسية")])),_:1})])])])],544)])]),T(u,{visible:l(g),"onUpdate:visible":s[5]||(s[5]=a=>m(g)?g.value=a:null),modal:"",class:"custum_dialog_width auth-daialog",draggable:!1},{default:A(()=>[t("div",Rs,[s[18]||(s[18]=t("h5",{class:"main-title sm blue mb-4"}," اختر المنصة التي ترغب في ربط متجرك بها عبر تطبيق بروزه من خلال سوق تطبيقات سلة وزد.",-1)),t("div",Fs,[t("button",{onClick:s[3]||(s[3]=()=>{q("https://apps.salla.sa/ar/app/853407611"),g.value=!1}),class:"typeSection salla"},s[16]||(s[16]=[t("img",{src:J,alt:""},null,-1)])),t("button",{onClick:s[4]||(s[4]=()=>{q("https://apps.zid.sa/application/4359"),g.value=!1}),class:"typeSection zid"},s[17]||(s[17]=[t("img",{src:K,alt:""},null,-1)]))])])]),_:1},8,["visible"]),T(u,{visible:l(h),"onUpdate:visible":s[10]||(s[10]=a=>m(h)?h.value=a:null),modal:"",class:"custum_dialog_width without-close auth-daialog",draggable:!1},{default:A(()=>[t("div",Gs,[s[21]||(s[21]=t("h5",{class:"main-title sm blue mb-4"}," يمكنك ربط متجرك مع تطبيق بروزه من خلال سوق تطبيقات سله و زد ",-1)),s[22]||(s[22]=t("h4",{class:"main-title bold mb-5"}," متجرك على أي منصة؟ ",-1)),t("div",Hs,[t("label",Js,[I(t("input",{type:"radio",value:"1",name:"checkType","onUpdate:modelValue":s[6]||(s[6]=a=>m(i)?i.value=a:null),class:"d-none",onChange:s[7]||(s[7]=a=>L("salla"))},null,544),[[F,l(i)]]),s[19]||(s[19]=t("img",{src:J,alt:""},null,-1))]),t("label",Ks,[I(t("input",{type:"radio",value:"2",name:"checkType","onUpdate:modelValue":s[8]||(s[8]=a=>m(i)?i.value=a:null),class:"d-none",onChange:s[9]||(s[9]=a=>L("zid"))},null,544),[[F,l(i)]]),s[20]||(s[20]=t("img",{src:K,alt:""},null,-1))])])])]),_:1},8,["visible"]),T(u,{visible:l(f),"onUpdate:visible":s[12]||(s[12]=a=>m(f)?f.value=a:null),modal:"",class:"custum_dialog_width without-close auth-daialog",draggable:!1},{default:A(()=>{var a,E,R;return[s[24]||(s[24]=t("div",{class:"text-center"},[t("h4",{class:"main-title bold mb-5"}," قم بإختيار نوع القطاع اولا ")],-1)),t("div",Os,[s[23]||(s[23]=t("label",{class:"label"},"القطاع",-1)),t("div",Qs,[(a=l(w))!=null&&a.length?(b(),G(ls,{key:0,modelValue:l(_),"onUpdate:modelValue":s[11]||(s[11]=ns=>m(_)?_.value=ns:null),display:"chip",options:l(w),optionLabel:"name",placeholder:"اختر نوع القطاع",maxSelectedLabels:(E=l(w))==null?void 0:E.length,class:"custum-dropdown"},null,8,["modelValue","options","maxSelectedLabels"])):(b(),G(os,{key:1,width:"100%",height:"40px"}))])]),t("button",{disabled:!((R=l(w))!=null&&R.length),type:"button",class:"custom-btn sm mr-auto mb-4",onClick:as},[$(r(e.$t("Auth.send"))+" ",1),l(y)?(b(),V("span",Xs)):z("",!0)],8,Ws)]}),_:1},8,["visible"])])}}};export{me as default};
