const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PTrpCiPf.js","./CUJchad6.js","./8xQljP0o.js","./entry.B0b_3z4T.css"])))=>i.map(i=>d[i]);
import N from"./CioiB6pW.js";import{_ as F}from"./BEwLbOQZ.js";import{s as O,h as I,A as U,B as q,l as E,r as o,e as T,m as J,o as y,c as A,a as s,b as m,g as V,w as L,_ as K,J as W,u as d,t as H,x as Q}from"./8xQljP0o.js";import{s as X}from"./DbXRVtgV.js";import{i as Y,a as Z,b as ee,c as te,f as ae,d as se,_ as oe,u as ne}from"./CUJchad6.js";import{u as R,r as G}from"./DXutHP6I.js";import{u as P}from"./DoPWajBm.js";import{i as M}from"./Bmvbube3.js";import{_ as re}from"./Cazn97jv.js";import{_ as le}from"./BljyFasq.js";import"./BYuOmsIA.js";import"./CZGijt7S.js";import"./Dbr_Mq8N.js";import"./B0o1YKYH.js";const ie=se(oe),ce={key:0,class:"skeleton-chart"},de={class:"skeleton-bars"},ue={class:"d-flex align-items-center gap-3 justify-content-end"},me={key:0,class:"w-100"},pe={class:"d-flex align-items-center justify-content-center gap-4"},_e={class:"with_cun_select custom-select"},fe={class:"flex justify-content-center dropdown_card"},he={__name:"Orders",props:{apiEndpoint:{type:String,required:!0}},async setup(B){let u,_;const f=R(),{response:D}=G(),{token:r}=O(P());I();const g=B,h=([u,_]=U(()=>q(()=>import("./PTrpCiPf.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),u=await u,_(),u);h.use([M,Y,Z,ee,te]);const x=E(()=>({headers:{Authorization:`Bearer ${r.value}`}})),v=o(!1),w=o(null),p=o(null),$=o([]),b=o([{name:"عرض الكل",id:0},{name:"يناير",id:1,days:31},{name:"فبراير",id:2,days:28},{name:"مارس",id:3,days:31},{name:"أبريل",id:4,days:30},{name:"مايو",id:5,days:31},{name:"يونيو",id:6,days:30},{name:"يوليو",id:7,days:31},{name:"أغسطس",id:8,days:31},{name:"سبتمبر",id:9,days:30},{name:"أكتوبر",id:10,days:31},{name:"نوفمبر",id:11,days:30},{name:"ديسمبر",id:12,days:31}]),a=o({tooltip:{trigger:"axis",axisPointer:{type:"none",label:{backgroundColor:"#6a7985"}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[],axisLabel:{interval:0,rotate:45}},yAxis:{type:"value",show:!1},series:[{type:"line",smooth:!0,symbol:"square",symbolSize:7,showSymbol:!0,lineStyle:{width:2,color:new h.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(247, 92, 92, 0.6)"},{offset:1,color:"rgba(247, 92, 92, 0.2)"}])},itemStyle:{color:"#E5254A"},areaStyle:{color:new h.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(247, 92, 92, 0.6)"},{offset:1,color:"rgba(247, 92, 92, 0.2)"}])},data:[]}]}),k=async(i=0)=>{var l,e;v.value=!0;try{const t=await f.get(`${g.apiEndpoint}${i?`?filterByMonth=${i}`:""}`,x.value);if(console.log("API Response:",t.data),D(t)==="success"){if(!((l=t.data)!=null&&l.data)){console.log("No data found in response"),a.value.xAxis.data=[],a.value.series[0].data=[];return}const c=t.data.data;console.log("Chart Data 222:",c),$.value=c;try{i===0?(a.value.xAxis.data=c.map(n=>n.month),a.value.series[0].data=c.map(n=>n.value)):(a.value.xAxis.data=c.map(n=>`اليوم ${n.month}`),a.value.series[0].data=c.map(n=>n.value)),(e=p.value)!=null&&e.chart&&p.value.chart.setOption(a.value,!0)}catch(n){console.error("Error mapping data:",n),console.log("Data structure:",c),a.value.xAxis.data=[],a.value.series[0].data=[]}}}catch(t){console.error("Error fetching peak time data:",t),a.value.xAxis.data=[],a.value.series[0].data=[]}finally{v.value=!1}},C=async i=>{var e;const l=(e=i.value)==null?void 0:e.id;l!==void 0&&await k(l)};return T(async()=>{w.value=b.value[0],await k()}),J($,()=>{var i;(i=p.value)!=null&&i.chart&&p.value.chart.setOption(a.value,!0)},{deep:!0}),(i,l)=>{const e=N,t=X,c=ie,n=ae;return y(),A("div",null,[v.value?(y(),A("div",ce,[s("div",de,[s("div",ue,[m(e,{width:"5rem",height:".5rem"}),l[1]||(l[1]=s("div",{class:"skeleton-bar",style:{width:"80%"}},null,-1))])])])):V("",!0),m(n,null,{default:L(()=>[v.value?V("",!0):(y(),A("div",me,[s("div",pe,[s("div",_e,[s("div",fe,[m(t,{modelValue:w.value,"onUpdate:modelValue":l[0]||(l[0]=S=>w.value=S),onChange:C,options:b.value,optionLabel:"name",placeholder:"اختر الشهر",class:"w-full md:w-14rem custum-dropdown"},null,8,["modelValue","options"])])])]),m(c,{ref_key:"chart",ref:p,class:"custom-chart",option:a.value,style:{height:"300px",width:"100%",display:"block"}},null,8,["option"])]))]),_:1})])}}},ve=""+new URL("cart-2._ylNWnxK.svg",import.meta.url).href,ye={class:"container"},ge={class:"info-box-item cart-clients gap-5 flex-wrap mb-4"},xe={class:"d-flex gap-3 justify-content-center flex-grow-1 align-items-center"},we={class:"info-content"},be={key:0},Ae={class:"layout-form chart_layout mb-3"},$e={class:"layout-form chart_layout mb-3"},ke={class:"layout-form chart_layout mb-3"},Ce={__name:"salesDetails",setup(B){ne([M]);const{response:u}=G(),_=R(),f=o([]),{token:D}=O(P()),r=o(!0),g=o(null),h=o(!1),x=E(()=>({headers:{Authorization:`Bearer ${D.value}`}})),v=o("تحديد الجنس"),w=o({showAll:"الكل",males:"الذكور",females:"الإناث"}),p=o("معدل الترك"),$=o({males:"الأقسام",females:"المنتجات"}),b=E(()=>f.value?{labels:f.value.map(e=>({id:e.id,text:e.name,image:e.logo})),series:f.value.map(e=>Number(e.precentage.toFixed(2))),colors:{text:"#ffffff"}}:{labels:[],series:[],colors:{bar:"#f75c5c",text:"#ffffff"}}),a=o([]),k=e=>{C(e)},C=async(e=1)=>{r.value=!0,await _.get(`DropoutRate?filter=${e}`,x.value).then(t=>{u(t)=="success"&&(f.value=t.data.data,b.value.colors.bar=e===2?"#e5254a":"#013660"),r.value=!1}).catch(t=>{console.error(t),r.value=!1})},i=async()=>{r.value=!0;try{const e=await _.get("AbandonedCartRateForGender?GenderType=0",x.value);if(u(e)==="success"){const t=e.data.data;Array.isArray(t)?(a.value=t,console.log("Updated Source Data:",a.value)):console.error("demographicData is not an array:",t)}}catch(e){console.error("Error fetching demographic data:",e)}finally{r.value=!1}},l=async()=>{r.value=!0,await _.get("TotalValueOfAbandonedCarts",x.value).then(e=>{u(e)=="success"&&(g.value=e.data.data),r.value=!1}).catch(e=>{console.error(e),r.value=!1})};return T(async()=>{await i(),await C(),await l()}),W(()=>{h.value=!0}),(e,t)=>{const c=N,n=F,S=he,j=re,z=le;return y(),A("div",ye,[s("div",ge,[s("div",xe,[t[1]||(t[1]=s("img",{src:ve,alt:"User Icon"},null,-1)),s("div",we,[t[0]||(t[0]=s("span",null,"إجمالي قيمة السلات المتروكة للمتجر:",-1)),d(g)!==null&&!d(r)?(y(),A("h2",be,H(d(g)),1)):d(r)?(y(),Q(c,{key:1,class:"mt-3",width:"5rem",height:".5rem"})):V("",!0)])]),m(n,{to:"/sales"},{default:L(()=>t[2]||(t[2]=[s("i",{class:"fas fa-chevron-right sales-icon"},null,-1)])),_:1})]),s("div",Ae,[t[3]||(t[3]=s("h1",{class:"main-title fw-normal text-center mb-5"},"متوسط حجم السلات المتروكة",-1)),m(S,{apiEndpoint:"AverageAbandonedCartSize"})]),s("div",$e,[m(j,{"data-ready":d(h),"products-data":d(b),"rental-names":d($),"placeholder-text":d(p),"show-select":!0,onFilterChange:k},null,8,["data-ready","products-data","rental-names","placeholder-text"])]),s("div",ke,[t[4]||(t[4]=s("h1",{class:"main-title fw-normal text-center mb-4"},"التحليل الديموغرافي",-1)),m(z,{"rental-names":d(w),"placeholder-text":d(v),"source-data":d(a)},null,8,["rental-names","placeholder-text","source-data"])])])}}},ze=K(Ce,[["__scopeId","data-v-936df7dd"]]);export{ze as default};
